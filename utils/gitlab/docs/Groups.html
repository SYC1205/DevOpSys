<!DOCTYPE html>

<html>
<head>
  <title>Groups.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="ApiBase.html">
                  ApiBase.coffee
                </a>
              
                
                <a class="source" href="ApiBaseHTTP.html">
                  ApiBaseHTTP.coffee
                </a>
              
                
                <a class="source" href="ApiV3.html">
                  ApiV3.coffee
                </a>
              
                
                <a class="source" href="BaseModel.html">
                  BaseModel.coffee
                </a>
              
                
                <a class="source" href="Groups.html">
                  Groups.coffee
                </a>
              
                
                <a class="source" href="IssueNotes.html">
                  IssueNotes.coffee
                </a>
              
                
                <a class="source" href="Issues.html">
                  Issues.coffee
                </a>
              
                
                <a class="source" href="Labels.html">
                  Labels.coffee
                </a>
              
                
                <a class="source" href="Notes.html">
                  Notes.coffee
                </a>
              
                
                <a class="source" href="ProjectDeployKeys.html">
                  ProjectDeployKeys.coffee
                </a>
              
                
                <a class="source" href="ProjectHooks.html">
                  ProjectHooks.coffee
                </a>
              
                
                <a class="source" href="ProjectIssues.html">
                  ProjectIssues.coffee
                </a>
              
                
                <a class="source" href="ProjectLabels.html">
                  ProjectLabels.coffee
                </a>
              
                
                <a class="source" href="ProjectMembers.html">
                  ProjectMembers.coffee
                </a>
              
                
                <a class="source" href="ProjectMergeRequests.html">
                  ProjectMergeRequests.coffee
                </a>
              
                
                <a class="source" href="ProjectMilestones.html">
                  ProjectMilestones.coffee
                </a>
              
                
                <a class="source" href="ProjectRepository.html">
                  ProjectRepository.coffee
                </a>
              
                
                <a class="source" href="Projects.html">
                  Projects.coffee
                </a>
              
                
                <a class="source" href="Users.html">
                  Users.coffee
                </a>
              
                
                <a class="source" href="Utils.html">
                  Utils.coffee
                </a>
              
                
                <a class="source" href="index.html">
                  index.coffee
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>Groups.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>BaseModel = <span class="hljs-built_in">require</span> <span class="hljs-string">'../BaseModel'</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Groups</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseModel</span></span>
  <span class="hljs-attribute">init</span>: <span class="hljs-function">=&gt;</span>
    <span class="hljs-property">@access_levels</span> =
      <span class="hljs-attribute">GUEST</span>:      <span class="hljs-number">10</span>
      <span class="hljs-attribute">REPORTER</span>:   <span class="hljs-number">20</span>
      <span class="hljs-attribute">DEVELOPER</span>:  <span class="hljs-number">30</span>
      <span class="hljs-attribute">MASTER</span>:     <span class="hljs-number">40</span>
      <span class="hljs-attribute">OWNER</span>:      <span class="hljs-number">50</span>

  <span class="hljs-attribute">all</span>: <span class="hljs-function"><span class="hljs-params">(params = {}, fn = <span class="hljs-literal">null</span>)</span> =&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-string">'function'</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">typeof</span> params
      fn = params
      params = {}
    <span class="hljs-property">@debug</span> <span class="hljs-string">"Groups::all()"</span>
    
    params.page ?= <span class="hljs-number">1</span>
    params.per_page ?= <span class="hljs-number">100</span>

    data = []
<span class="hljs-function">    <span class="hljs-title">cb</span> = <span class="hljs-params">(err, retData)</span> =&gt;</span>
      <span class="hljs-keyword">if</span> err
        <span class="hljs-keyword">return</span> fn(retData || data) <span class="hljs-keyword">if</span> fn
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> retData.length == params.per_page
        <span class="hljs-property">@debug</span> <span class="hljs-string">"Recurse Groups::all()"</span>
        data = data.concat(retData)
        params.page++
        <span class="hljs-keyword">return</span> <span class="hljs-property">@get</span> <span class="hljs-string">"groups"</span>, params, cb
      <span class="hljs-keyword">else</span>
        data = data.concat(retData)
        <span class="hljs-keyword">return</span> fn data <span class="hljs-keyword">if</span> fn

    <span class="hljs-property">@get</span> <span class="hljs-string">"groups"</span>, params, <span class="hljs-function"><span class="hljs-params">(data)</span> =&gt;</span> fn data <span class="hljs-keyword">if</span> fn

  <span class="hljs-attribute">show</span>: <span class="hljs-function"><span class="hljs-params">(groupId, fn = <span class="hljs-literal">null</span>)</span> =&gt;</span>
    <span class="hljs-property">@debug</span> <span class="hljs-string">"Groups::show()"</span>
    <span class="hljs-property">@get</span> <span class="hljs-string">"groups/<span class="hljs-subst">#{parseInt groupId}</span>"</span>, <span class="hljs-function"><span class="hljs-params">(data)</span> =&gt;</span> fn data <span class="hljs-keyword">if</span> fn

  <span class="hljs-attribute">listProjects</span>: <span class="hljs-function"><span class="hljs-params">(groupId, fn = <span class="hljs-literal">null</span>)</span> =&gt;</span>
    <span class="hljs-property">@debug</span> <span class="hljs-string">"Groups::listProjects()"</span>
    <span class="hljs-property">@get</span> <span class="hljs-string">"groups/<span class="hljs-subst">#{parseInt groupId}</span>"</span>, <span class="hljs-function"><span class="hljs-params">(data)</span> =&gt;</span> fn data.projects <span class="hljs-keyword">if</span> fn
        
  <span class="hljs-attribute">listMembers</span>: <span class="hljs-function"><span class="hljs-params">(groupId, fn = <span class="hljs-literal">null</span>)</span> =&gt;</span>
    <span class="hljs-property">@debug</span> <span class="hljs-string">"Groups::listMembers()"</span>
    <span class="hljs-property">@get</span> <span class="hljs-string">"groups/<span class="hljs-subst">#{parseInt groupId}</span>/members"</span>, <span class="hljs-function"><span class="hljs-params">(data)</span> =&gt;</span> fn data <span class="hljs-keyword">if</span> fn

  <span class="hljs-attribute">addMember</span>: <span class="hljs-function"><span class="hljs-params">(groupId, userId, accessLevel, fn=<span class="hljs-literal">null</span>)</span> =&gt;</span>
    <span class="hljs-property">@debug</span> <span class="hljs-string">"addMember(<span class="hljs-subst">#{groupId}</span>, <span class="hljs-subst">#{userId}</span>, <span class="hljs-subst">#{accessLevel}</span>)"</span>
<span class="hljs-function">
    <span class="hljs-title">checkAccessLevel</span> = =&gt;</span>
      <span class="hljs-keyword">for</span> k, access_level <span class="hljs-keyword">of</span> <span class="hljs-property">@access_levels</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">if</span> accessLevel == access_level
      <span class="hljs-literal">false</span>

    <span class="hljs-keyword">unless</span> <span class="hljs-keyword">do</span> checkAccessLevel
      <span class="hljs-keyword">throw</span> <span class="hljs-string">"`accessLevel` must be one of <span class="hljs-subst">#{JSON.stringify <span class="hljs-property">@access_levels</span>}</span>"</span>

    params =
      <span class="hljs-attribute">user_id</span>: userId
      <span class="hljs-attribute">access_level</span>: accessLevel

    <span class="hljs-property">@post</span> <span class="hljs-string">"groups/<span class="hljs-subst">#{parseInt groupId}</span>/members"</span>, params, <span class="hljs-function"><span class="hljs-params">(data)</span> -&gt;</span> fn data <span class="hljs-keyword">if</span> fn


<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">(client)</span> -&gt;</span> <span class="hljs-keyword">new</span> Groups client</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
